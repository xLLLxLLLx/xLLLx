



### Contest 6

[Codeforces293-Round#174Div1](https://codeforces.com/contest/283)

[å®˜æ–¹é¢˜è§£](https://codeforces.com/blog/entry/7036)

> - Y::solved in the contest
> - A::solved after the contest
> - S::solving ::sob:
> - X::tan90

------æˆ‘æ˜¯vpåˆ†å‰²çº¿------

æˆ‘ä¹Ÿä¸çŸ¥é“è¯¥è¯´å•¥äº†ã€‚ã€‚è¢«è‡ªå·±è ¢å“­ã€‚ã€‚

Aé¢˜æ˜æ˜æ˜¯ä¸ªå¤§æ°´é¢˜ï¼~~æˆ‘å·®ç‚¹å·®ç‚¹å·®ç‚¹ å°±å†™äº†çº¿æ®µæ ‘ã€‚ã€‚ã€‚ï¼ˆåŒºé—´ä¿®æ”¹çš„é‚£ç§~~

Bé¢˜ä¹Ÿæ²¡æœ‰ä»»ä½•æ€ç»´å«é‡(~~è™½ç„¶æˆ‘å†™äº†å¾ˆä¹…~~

å®Œå…¨å°±æ˜¯æš´åŠ›æš´åŠ›æš´åŠ›ã€‚ã€‚æ³¨æ„ä¸€ä¸‹ç»†èŠ‚å°±å¯ä»¥äº†ã€‚ã€‚~~Bé¢˜å‘Šè¯‰æˆ‘ã€‚ã€‚â€”â€”äººè¦æœ‰ä¿¡ä»°ã€‚ã€‚~~

Cé¢˜å’•å’•å’•ã€‚ã€‚åªä¼šæŠŠæ‰€æœ‰çŠ¶æ€éƒ½æ”¾åˆ°dpé‡Œé¢å»qwq

Dé¢˜smgä¸ä¼šå†è§ğŸ‘‹

Eé¢˜å’‹åˆæ˜¯è®¡æ•°ï¼ä¸ä¼šå†è§ğŸ‘‹ï¼ˆäº‹å®ä¸Šè¿™ä¸ªEé¢˜æ˜¯æˆ‘åšè¿‡çš„Div1æœ€åä¸€é“é¢˜é‡Œé¢æœ€å¯åšçš„äº†qwq

æ€»è€Œè¨€ä¹‹ æ„Ÿè§‰è¿™åœºæ¯”èµ›ç¡®å®ä¸éš¾ã€‚ã€‚ã€‚

~~æœ€è®©æˆ‘éª„å‚²çš„æ˜¯ è‡³å°‘æˆ‘é¢˜ç›®è¿˜æ˜¯çœ‹å¾—æ‡‚çš„ï¼~~

-----è¿˜æ˜¯å†™é¢˜(~~ç~~)è§£(~~è®²~~)æŠ¥å‘Šæ¯”è¾ƒå¥½ç©------

#### A

å¤§æ°´é¢˜ï¼

ç•¥ï½

#### B

æ³¥æŠŠè¿™é“é¢˜è½¬æ¢æˆ<font color="blue">å›¾æ¨¡å‹</font>å°±å¯ä»¥å•¦ï¼

æ³¨æ„ç»†èŠ‚å°±æ²¡æœ‰é—®é¢˜ï½

#### C

~~Cé¢˜æ˜¯ä»€ä¹ˆsbé¢˜ã€‚ã€‚æ°´çš„ä¸€çš®~~

è€ƒè™‘å¤æ‚åº¦ é‡åˆ°dpåªä¼šæŠŠæ‰€æœ‰çŠ¶æ€éƒ½æ”¾åˆ°dpçŠ¶æ€ä¸Šçš„ä½ å‘ç° tmåªèƒ½å¼€ä¸ª1ç»´çš„æ ·å­

æƒ³æ¥æƒ³å» ä½ å‘ç°æœ‰ä¸€ç»´æ˜¯ç»å¯¹è¦çš„

ç„¶åæ™ºéšœçš„ä½ åœ¨æ€è€ƒ ä½ è¦æ»¡è¶³è¿™ä¸ªé™åˆ¶å•Š

é‚£ä¹ˆå…ˆæ»¡è¶³æœ€åŸºæœ¬çš„ä¸œè¥¿å˜›ã€‚ã€‚

å°±æ˜¯å¦‚æœæœ€å°çš„é‚£ä¸ªé€‰äº†$x$ä¸ª é‚£ä¹ˆä¸ä¹‹ç›¸è”ç³»çš„ç¡¬å¸ä½ éƒ½é€‰$x$ä¸ª

ç„¶åä½ å°±å‘ç° è¿™tmæ˜¯ä¸ªä»€ä¹ˆæ€åšé¢˜ã€‚ã€‚

ä»€ä¹ˆæ€åšé¢˜ï¼æ€ä¹ˆå¯ä»¥è¿™ä¹ˆæ€åšï¼

æ‰“ä¸ªæ¯”æ–¹ $num_x < num_y <num_z$

é‚£ä½ æŠŠ$w_x = a_x + a_y + a_z,w_y = a_y +a_z,w_z=a_z$

ç„¶åä½ å†è·‘ä¸ªä»€ä¹ˆå¤šé‡èƒŒåŒ…ï¼tmå°±å®Œäº‹äº†ã€‚

ï¼ˆå½“ç„¶ä½ å…ˆè¦æ»¡è¶³æœ€åŸºæœ¬çš„æ¡ä»¶ã€‚ã€‚ã€‚

#### D

ä¸€é“è‚¥è‚ æµå¼Šçš„é¢˜ã€‚ã€‚ã€‚

è¿˜æ˜¯è¢«æˆ‘çš„æ•°å­¦èœåˆ°äº†ã€‚ã€‚

<font color="blue">**é¦–å…ˆæˆ‘ä»¬å‘ç°è¿™ä¸ª$n$åªæœ‰$5000$! ç„¶åæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘$n^2$åšæ³•å•¦ï½**</font>

å¯¹äº$y$ä¸ªè¿ç»­çš„æ•° å’Œä¸º$x$ æˆ‘ä»¬å¯ä»¥æ¨å‡ºè¿™ä¹ˆä¸€ä¸ªå¼å­

$\dfrac{(2*a+y-1)*y}{2}=x$

ä»è€Œ $2*a-1=\dfrac{2*x-y^2}{y}$

é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¾—å‡º$\dfrac{2*x-y^2}{y}$éœ€è¦æ˜¯ä¸ªå¥‡æ•°

é‚£ä¹ˆæˆ‘ä»¬å°†æ•°åˆ’åˆ†æˆ$x=2^p*q$

é‚£ä¹ˆ$x,y$éœ€è¦æ»¡è¶³çš„æ¡ä»¶

- $q_x$%$q_y$$=0$

- $p_x+1=p_y$||$p_y=0$

  

æˆ‘ä»¬è®¾$f[i]$è¡¨ç¤ºå‰$i$ä¸ªæœ€å°‘éœ€è¦ä¿®æ”¹å‡ ä¸ª

#### E

<font color="blue">**é‡éš¾åˆ™å**</font>

<font color="blue">**ä¸€ä¸ªä¸‰å…ƒç»„$(a,b,c)$ä¸æ»¡è¶³æ¡ä»¶çš„æƒ…å†µå°±æ˜¯å…¶ä¸­ä¸€ä¸ªæ•°çš„èƒ½åŠ›å¤§äºå¦å¤–ä¸¤ä¸ªæ•°**</font>

æˆ‘ä»¬çŸ¥é“ä¸€å…±æœ‰$C_n^3$ä¸ªä¸‰å…ƒç»„

é‚£ä¹ˆä¸€ä¸ªæ•°$a$æ‰“èµ¢å¦ä¸€ä¸ªæ•°$b$ æƒ…å†µä¹Ÿåªæœ‰ä¸¤ç§

- æœ¬èº«$a$å°±æ¯”$b$å¤§ è€Œä¸”åè½¬äº†å¶æ•°æ¬¡
- æœ¬èº«$a$å°±æ¯”$b$å° è€Œä¸”åè½¬äº†å¥‡æ•°æ¬¡

è¿™ç§åŒºé—´åè½¬å¤šå°‘æ¬¡æˆ‘ä»¬å¯ä»¥æ”¾åˆ°çº¿æ®µæ ‘ä¸Šå»æ±‚

ç°å°†$a$æŒ‰ä»å°åˆ°å¤§æ’åº 

æšä¸¾åˆ°ä¸€ä¸ª$i$ æˆ‘ä»¬å°†æ‰€æœ‰ä»¥$i$ä¸ºå·¦ç«¯ç‚¹çš„åŒºé—´æ”¾åˆ°çº¿æ®µæ ‘é‡Œå»

è®¡ç®—å®Œ$i$çš„è´¡çŒ®æ—¶ æˆ‘ä»¬å°±å°†æ‰€æœ‰ä»¥$i$ä¸ºå³ç«¯ç‚¹çš„çº¿æ®µä»çº¿æ®µæ ‘é‡Œå»é™¤å½±å“

ç„¶åä½ å‘ç°ä½ å°±å†™å®Œäº†ä¸€é“Div1ï¼çš„æœ€åä¸€é¢˜ï¼

æ’’èŠ±èŠ±:cherry_blossom:

------Code!------

##### A

```c++
#include <bits/stdc++.h>
#define ll long long
using namespace std;
const int N = 2e5 + 10;
ll add[N], a[N];

int main() {
	ll sum = 0;
	int now = 1, n;
	scanf("%d", &n);
	for(int i = 1, tp; i <= n; ++i) {
		scanf("%d", &tp);
		if(tp == 1) {
			int x, y;
			scanf("%d%d", &x, &y);
			add[x] += y;
			sum += 1ll * x * y;
		} else if(tp == 2) {
			int x;
			scanf("%d", &x);
			sum += x, a[++now] = x;
		} else {
			add[now - 1] += add[now];
			sum -= add[now] + a[now];
			add[now] = a[now] = 0;
			now--;
		}
		printf("%.10f\n", double(sum) / double(now));
	}
	return 0;
}
```

##### B

```c++
#include <bits/stdc++.h>
#define ll long long
using namespace std;
const int N = 1e6 + 10;
ll dis[N], a[N];
int vis[N], ed[N], vv[10], res = 0, n;

int zh(int y, int x) {
	return x * n + y;
}

void go(int x, int id) {
	// printf("%d %d\n", x, id);
	int num = zh(x, id);
	if(x == 1) {
		ed[num] = id + 1;
		return ;
	}
	vis[num] = res;
	if(!id) {
		int pos = x + a[x], nid = id ^ 1;
		int tmp = zh(pos, nid);
		if(pos > n) {
			dis[num] = a[x];
			return ;
		} else if(vis[tmp] == vis[num]) {
			dis[num] = -1;
			return ;
		} else {
			if(!vis[tmp]) {
				go(pos, nid);
			}
			if(dis[tmp] == -1) dis[num] = -1;
			else dis[num] = dis[tmp] + a[x];
			ed[num] = ed[tmp];
		}
	} else {
		int pos = x - a[x], nid = id ^ 1;
		int tmp = zh(pos, nid);
		if(pos <= 0) {
			dis[num] = a[x];
			return ;
		} else if(vis[num] == vis[tmp]) {
			dis[num] = -1;
			return ;
		} else {
			if(!vis[tmp]) {
				go(pos, nid);
			}
			if(dis[tmp] == -1) dis[num] = -1;
			else dis[num] = dis[tmp] + a[x];
			ed[num] = ed[tmp];
		}
	}
}

int main() {
	scanf("%d", &n);
	for(int i = 2; i <= n; ++i) {
		cin >> a[i];
	}
	for(int i = 2; i <= n; ++i) 
	 for(int j = 0; j < 2; ++j) {
		if(!vis[zh(i, j)]) {
			++res;
			go(i, j);
		}
	}
	for(int i = 1; i < n; ++i) {
		memset(vv, 0, sizeof vv);
		int tt = zh(i + 1, 1);
		ll pos = dis[tt];
		if(ed[tt] == 1) {
			printf("-1\n");
		} else if(ed[tt] == 2){
			cout << pos + i + i << endl;
		} else {
			if(pos == -1) printf("-1\n");
			else cout << pos + i <<endl;
		}
	}
	return 0;
}
```

##### C

```c++
#include <bits/stdc++.h>
#define ll long long
using namespace std;
const int N = 1e5 + 10, mod = 1e9 + 7;
int a[N], mx[N], my[N], vis[N], w[N];
ll f[N];

int main() {
	int n, q, t;
	scanf("%d%d%d", &n, &q, &t);
	for(int i = 1; i <= n; ++i) {
		scanf("%d", &a[i]);
	}
	for(int i = 1, x, y; i <= q; ++i) {
		scanf("%d%d", &x, &y);
		mx[x] = y, my[y] = x;
	}
	for(int i = 1; i <= n; ++i) {
		if(!my[i]) {
			// printf("qwq%d\n", i);
			int tmp = i, pos = a[tmp];
			w[tmp] = pos;
			while(mx[tmp]) {
				t -= pos;
				if(t < 0) return printf("0\n"), 0;
				tmp = mx[tmp];
				pos += a[tmp];
				w[tmp] = pos;
			}
		}
	}
	f[0] = 1;
	for(int i = 1; i <= n; ++i) {
		if(!w[i]) return printf("0\n"), 0;
		for(int j = w[i]; j <= t; ++j) {
			f[j] = (f[j] + f[j - w[i]]) % mod;
		}
	}
	// printf("%d\n", t);
	if(t >= 0) printf("%lld\n", f[t]);
	else {
		printf("0\n");
	}
	return 0;
}
```

##### D

```c++
#include <bits/stdc++.h>
#define ll long long
using namespace std;
const int N = 5050;
int f[N];
ll q[N], p[N];

bool check(int x, int y) {
	if(q[x] % q[y]) return false;
	return p[y] - p[x] == y - x || p[y] < y - x;
}

int main() {
	int n;
	scanf("%d", &n);
	for(int i = 0; i < n; ++i) {
		ll x;
		cin >> x;
		p[i] = 0;
		while(x % 2 == 0) p[i]++, x /= 2;
		q[i] = x;
	}
	memset(f, 0x3f, sizeof f);
	f[0] = 0, q[n] = 1;
	for(int i = 1; i <= n; ++i) {
		f[i] = i;
		for(int j = 0; j < i; ++j) {
			if(check(j, i)) {
				f[i] = min(f[i], f[j] + i - j - 1);
			}
		}
	}
	printf("%d\n", f[n]);
	return 0;
}
```

##### E

```c++
#include<bits/stdc++.h>
#define ls x << 1
#define rs x << 1 | 1
#define ll long long
using namespace std;
const int N = 1e5 + 10;
struct data {
	int l, r;
} xd[N];
struct node {
	int js, os;
} tr[N << 2];
vector<int> b[N], e[N];
int a[N], all[N << 2];
int rev[N << 2], n, k;

int getl(int x) {
	int l = 1, r = n, ans = 1;
	while(l <= r) {
		int mid = (l + r) >> 1;
		if(all[mid] >= x) r = mid - 1, ans = mid;
		else l = mid + 1;
	}
	return ans;
}

int getr(int x) {
	int l = 1, r = n, ans = n;
	while(l <= r) {
		int mid = (l + r) >> 1;
		if(all[mid] <= x) l = mid + 1, ans = mid;
		else r = mid - 1;
	}
	return ans;
}

node merge(node A, node B) {
	node res;
	res.js = A.js + B.js;
	res.os = A.os + B.os;
	return res;
}

void build(int x, int l, int r) {
	if(l == r) {
		tr[x].os = 1;
		tr[x].js = 0;
		return ;
	}
	int mid = (l + r) >> 1;
	build(ls, l, mid), build(rs, mid + 1, r);
	tr[x] = merge(tr[ls], tr[rs]);
}

void down(int x) {
	if(rev[x]) {
		rev[x] = 0;
		rev[ls] ^= 1;
		rev[rs] ^= 1;
		swap(tr[ls].os, tr[ls].js);
		swap(tr[rs].os, tr[rs].js);
	}
}

void put(int x, int l, int r, int L, int R) {
	// printf("x=%d l=%d r=%d\n", x,l,r);
	if(L <= l && r <= R) {
		rev[x] ^= 1;
		swap(tr[x].os, tr[x].js);
		// printf("qwqx=%d l=%d r=%d os=%d js=%d\n",x,l,r,tr[x].js,tr[x].os);
		return ;
	}
	down(x);
	int mid = (l + r) >> 1;
	if(L <= mid) put(ls, l, mid, L, R);
	if(R > mid) put(rs, mid + 1, r, L, R);
	tr[x] = merge(tr[ls], tr[rs]);
	// printf("x=%d l=%d r=%d os=%d js=%d\n", x, l, r, tr[x].os,tr[x].js);
}

node get(int x, int l, int r, int L, int R) {
	if(L > R) {
		return (node){0, 0};
	}
	if(L <= l && r <= R) {
		return tr[x];
	}
	down(x);
	int mid = (l + r) >> 1;
	node ans1, ans2;
	if(L <= mid) ans1 = get(ls, l, mid, L, R);
	else ans1.js = ans1.os = 0;
	if(R > mid) ans2 = get(rs, mid + 1, r, L, R);
	else ans2.js = ans2.os = 0;
	tr[x] = merge(tr[ls], tr[rs]);
	return merge(ans1, ans2);
}

int main() {
	scanf("%d%d", &n, &k);
	int res = 0;
	for(int i = 1; i <= n; ++i) {
		scanf("%d", &a[i]);
		all[i] = a[i];
	}
	sort(a + 1, a + 1 + n), sort(all + 1, all + 1 + n);
	for(int i = 1; i <= n; ++i) {
		a[i] = lower_bound(all + 1, all + 1 + n, a[i]) - all;
	}
	for(int i = 1; i <= k; ++i) {
		scanf("%d%d", &xd[i].l, &xd[i].r);
		xd[i].l = getl(xd[i].l);
		xd[i].r = getr(xd[i].r);
		b[xd[i].l].push_back(i), e[xd[i].r].push_back(i);
	}
	ll ans = 1ll * n * (n - 1) * (n - 2) / 6;
	build(1, 1, n);
	for(int i = 1, len; i <= n; ++i) {
		// printf("qwq%d\n", i);
		len = b[i].size();
		for(int j = 0; j < len; ++j) {
			// printf("%d %d\n", xd[b[i][j]].l, xd[b[i][j]].r);
			put(1, 1, n, xd[b[i][j]].l, xd[b[i][j]].r);
		}
		ll tmp = 0;
		tmp += get(1, 1, n, 1, i - 1).os + get(1, 1, n, i + 1, n).js;
		// printf("%lld\n", tmp);
		ans -= tmp * (tmp - 1) / 2;
		len = e[i].size();
		for(int j = 0; j < len; ++j) {
			put(1, 1, n, xd[e[i][j]].l, xd[e[i][j]].r);
		}
	}
	printf("%lld\n", ans);
	return 0;
}
```

äº‹å®ä¸Šæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„ä»£ç æ˜¯åˆ«äººçš„ä¸¤å€é•¿qwq